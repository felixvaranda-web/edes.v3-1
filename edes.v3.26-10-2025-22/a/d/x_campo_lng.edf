#include(*) $lng/x_campo.edf.lng
[Title]=@NOMBRE CAMPOS A EXTRAER@
[DBTable]{$_ENV['SYSDB']}gs_campo
[DBIndex]cd_gs_campo; cd_gs_entidad,tabla,campo,relacion,tipo
[DBSerial]cd_gs_campo
[RelationFields]cd_gs_entidad,cd_gs_grupo
[Button]a|Generar
[AddOption]*|nivel|,; 1,Básico; 2,Medio; 3,Total; 9,INFORMATICA
[PersistentVar]_LngEdit
[EditList]etiqueta,label_tab
[Fields]
|cd_gs_campo|+|T|5||*|||
@Entidad@|cd_gs_entidad|0|S|30|230|QA||#|
@Grupo@|cd_gs_grupo|D|Ss|30|cd_gs_entidad|QA||#|
@Campo@|campo|x|T|80|cd_gs_entidad|QA||#|
@Texto en·Listados@|etiqueta|#U|T|30|cd_gs_entidad|QM||#|
@Texto en·Fichas@|label_tab|#U|T|30|cd_gs_entidad|QM|||
[PHPIni]m,ml
global $_Mode, $_SubMode, $_Form;
if( SS::count("{$_ENV['SYSDB']}gs_language", "tf_translation='{$_ENV['ON']}'")>1 ){
if( $_Mode=='m' ){
$_Form[3][1] = 'etiqueta_'.$_LngEdit;
$_Form[4][1] = 'label_tab_'.$_LngEdit;
}else{
$_Form[4][1] = 'etiqueta_'.$_LngEdit;
$_Form[5][1] = 'label_tab_'.$_LngEdit;
}
if( $_SubMode=='ml' ){
global $_EDITLIST;
$_EDITLIST[0] = ',etiqueta_'.$_LngEdit.',label_tab_'.$_LngEdit.',';
}
}
[PHPForm]mR
global $_Mode, $_SubMode, $_Form, $_LngEdit;
if( SS::count("{$_ENV['SYSDB']}gs_language", "tf_translation='{$_ENV['ON']}'")>1 ){
global $_ONCHANGE, $_ADDCODE;
eAddField('-|@Lenguaje@||||||||');
SS::query( "select * from {$_ENV['SYSDB']}gs_language where tf_translation='{$_ENV['ON']}' order by nm_gs_language", [], 1 );
while( $r=SS::get(1) ){
if( trim($r['cd_gs_language'])=='es' ){
eAddField( eUcFirst(trim($r['nm_gs_language'])).' | etiqueta_'.$r['cd_gs_language'].' | D | T | 30 || * |||');
$_ONCHANGE[] = array( 'etiqueta', 'ePF("etiqueta_es",eGF("etiqueta"));', '', '' );
eAddField( eUcFirst(trim($r['nm_gs_language'])).' | label_tab_'.$r['cd_gs_language'].' | D | T | 30 || * |||');
$_ONCHANGE[] = array( 'label_tab', 'ePF("label_tab_es",eGF("label_tab"));', '', '' );
}else{
eAddField( '@Texto en·Listados@ | etiqueta_'.$r['cd_gs_language'].' | D | T | 30 |230| M || # |');
if( $_Mode=='a' ) $_ONCHANGE[] = array( 'etiqueta', 'ePF("etiqueta_'.trim($r['cd_gs_language']).'",eGF("etiqueta"));', '', '' );
$_ADDCODE['etiqueta_'.$r['cd_gs_language']]['E'] = ' '.eUcFirst(trim($r['nm_gs_language']));
eAddField( '@Texto en·Fichas@ | label_tab_'.$r['cd_gs_language'].' | D | T | 30 |230| M |||');
if( $_Mode=='a' ) $_ONCHANGE[] = array( 'label_tab', 'ePF("label_tab_'.trim($r['cd_gs_language']).'",eGF("label_tab"));', '', '' );
$_ADDCODE['label_tab_'.$r['cd_gs_language']]['E'] = ' '.eUcFirst(trim($r['nm_gs_language']));
}
}
}
[AddOption]m,mR|tabla|uTablas()
[PHPIni]m,mR
function uTablas(){
if( SS::isDriver("informix") ){
SS::query("select tabname,tabtype from systables where tabid>100");
}else if( SS::isDriver("oci") ){
global $_SqlUsuario; $SqlUsuario = mb_strtoupper($_SqlUsuario);
$sql = "SELECT TABLE_NAME FROM all_tables where OWNER='{$SqlUsuario}'";
SS::query( $sql );
}else if( SS::isDriver('mysql,mysqli') ){
SS::query( 'show tables' );
}
$Dim = array();
while( $row = SS::get("num") ){
if( SS::isDriver("informix") ){
if( $row[1]=='S' ){
$Dim[] = trim($row[0]);
}else{
$Dim[] = trim($row[0]);
}
}else if( SS::isDriver("oci") ){
$Dim[] = mb_strtolower(trim($row[0]));
}else if( SS::isDriver('mysql,mysqli') ){
$Dim[] = trim($row[0]);
}
}
sort($Dim);
$DimTablas = array();
for( $n=0; $n<count($Dim); $n++ ) $DimTablas[] = array( $Dim[$n], mb_strtoupper($Dim[$n]) );
return $DimTablas;
}