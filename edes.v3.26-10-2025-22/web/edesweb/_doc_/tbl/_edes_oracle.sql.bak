# --------------------
# GESTION DE OPCIONES
# --------------------

CREATE TABLE gs_tree (
	cd_gs_tree number(3) not null serial,
	nm_gs_tree varchar2(60) not null,
	cd_tree char(10),
	filename varchar2(30) not null,
	permission char(1),
	extract char(1),
	print char(1),
	excel char(1),
	xml char(1),
	txt char(1),
	mdb char(1),
	pdf char(1),
	email char(1),
	news char(1),
	rmvfstlvl char(1),
	warnings number(3) not null,
	description varchar2(255),
	cdi datetime
);
create unique index gs_tree on gs_tree (nm_gs_tree);

create table gs_op (
	mode char(1),
	seq integer DEFAULT '0',
	seq_parent integer DEFAULT '0',
	indent smallint DEFAULT '0',
	caption varchar(255),
	tip varchar(255),
	type char(1),
	cd_gs_op integer,
	script_url varchar(255),
	icon varchar(25),
	status varchar(1) NOT NULL,
	dt_status date NOT NULL,
	cd_gs_user integer,
	icons varchar(60),
	show_type char(1),
	dt_add date,
	alias varchar(20)
);
create UNIQUE index gs_op_1 on gs_op (cd_gs_op);
create index gs_op_2 on gs_op ( seq );

create table gs_tree_op (
	cd_gs_tree integer NOT NULL,
	cd_gs_op integer NOT NULL
);
create UNIQUE index gs_tree_op   on gs_tree_op (cd_gs_tree, cd_gs_op);
create        index gs_tree_op_2 on gs_tree_op (cd_gs_op);

create table gs_op_ico (
	cd_gs_op_ico serial not null,
	nm_gs_op_ico varchar(45),
	activo char(1),
	global char(1),
	position smallint,
	status char(1),
	icon varchar(30),
	title varchar(80),
	add_html varchar(100),
	note varchar(255),
	mode char(1),
	show_type char(1),
	dt_status date NOT NULL,
	cd_gs_user integer,
	alias varchar(20),
	classname varchar(20),
	separator_group char(1)
);

create table gs_user_tree (
	cd_gs_user integer NOT NULL,
	cd_gs_tree smallint NOT NULL,
	mode varchar(19)
);
create UNIQUE index gs_user_tree on gs_user_tree (cd_gs_user, cd_gs_tree);

create table gs_user_op (
	cd_gs_user integer NOT NULL,
	cd_gs_tree smallint NOT NULL,
	action char(1) NOT NULL,
	cd_gs_op integer NOT NULL
);
create UNIQUE index gs_user_op on gs_user_op (cd_gs_user, cd_gs_tree, action, cd_gs_op);
create index gs_user_op_2 on gs_user_op (cd_gs_user,cd_gs_op,action);
create index gs_user_op_3 on gs_user_op (cd_gs_op,action);

#---

create table gs_rol (
	cd_gs_rol serial NOT NULL,
	nm_gs_rol varchar(60) NOT NULL,
	cd_gs_node integer,
	permission char(1),
	description varchar(255)
	print char(1),
	excel char(1),
	xml char(1),
	txt char(1),
	pdf char(1),
	mdb char(1),
	log_user char(1),
	log_history char(1),
	export_level char(1),
);
create UNIQUE index gs_rol on gs_rol (nm_gs_rol);

create table gs_rol_tree (
	cd_gs_rol integer NOT NULL,
	cd_gs_tree smallint NOT NULL,
	mode varchar(19)
);
create UNIQUE index gs_rol_tree on gs_rol_tree (cd_gs_rol, cd_gs_tree);

create table gs_rol_op (
	cd_gs_rol integer NOT NULL,
	cd_gs_tree smallint NOT NULL,
	action char(1),
	cd_gs_op integer NOT NULL
);
create UNIQUE index gs_rol_op on gs_rol_op (cd_gs_rol, cd_gs_tree, action, cd_gs_op);
create index gs_rol_op_2 on gs_rol_op (cd_gs_rol,cd_gs_op,action);

create table gs_rol_permission (
	cd_gs_rol integer NOT NULL,
	cd_gs_tpermission integer NOT NULL
);
create UNIQUE index gs_rol_permission on gs_rol_permission (cd_gs_rol, cd_gs_tpermission);

# --------------------

create table gs_tpermission (
	cd_gs_tpermission serial NOT NULL,
	nm_gs_tpermission varchar(30),
	script varchar(30),
	active char(1),
	type char(1),
	note varchar(255),
	options varchar(60),
	icons varchar(30),
	dt_add date
);
create UNIQUE index cd_gs_tpermission_1 on gs_tpermission (cd_gs_tpermission);
create UNIQUE index cd_gs_tpermission_2 on gs_tpermission (script, nm_gs_tpermission);
create index cd_gs_tpermission_3 on gs_tpermission (note);

create table gs_permission (
	cd_gs_user integer NOT NULL,
	cd_gs_tpermission integer NOT NULL
);
create UNIQUE index gs_permission on gs_permission (cd_gs_user, cd_gs_tpermission);

create table gs_permission_op (
	cd_gs_user integer NOT NULL,
	option_id integer NOT NULL,
	visible char(1) NOT NULL
);
create UNIQUE index gs_permission_op on gs_permission_op (cd_gs_user, option_id);

create table gs_permission_ico (
	cd_gs_user integer NOT NULL,
	cd_gs_tpermission integer NOT NULL,
	visible char(1)
);
create UNIQUE index gs_permission_ico on gs_permission_ico (cd_gs_user, cd_gs_tpermission);

# ------------
# ESTADISTICA
# ------------

CREATE TABLE gs_navegador (
	cd_gs_navegador number(5) not null serial,
	nm_gs_navegador varchar2(50) not null,
	nombre varchar2(30) not null,
	resolucion varchar2(12) not null,
	varios varchar2(7) not null
);
create index gs_navegador on gs_navegador (nm_gs_navegador, nombre, resolucion, varios);

CREATE TABLE gs_conexion (
	conexion number(7) not null serial,
	id varchar2(40) not null,
	exe char(1),
	cd_server tinyint unsigned,
	cd_gs_tree number(3) not null,
	cd_gs_user number(3) not null,
	cdi timestamp not null,
	cd_gs_navegador number(5) not null,
	ip varchar2(15) not null,
	cd_gs_node number(3) not null,
	sg_carga number(3),
	cdi_fin timestamp,
	zip char(1) not null,
	cd_gs_pc number(3),
	access tinyint unsigned,
	sesion varchar2(2000)
);
create index gs_conexion  on gs_conexion (cdi,cd_gs_user);
create index gs_conexion2 on gs_conexion (id) 

CREATE TABLE gs_acceso (
	num_acceso number(4) not null serial,
	cd_gs_toperacion char(3) not null,
	conexion number(7) not null,
	objeto char(1),
	modo char(2),
	edf varchar2(40),
	tabla varchar2(20),
	parametros varchar2(80),
	cdi timestamp,
	pagina varchar2(80),
	parametro varchar2(80),
	registros number(8) not null,
	uso_cpu number(4),
	byts number(8),
	cd_gs_node number(3) not null,
	cd_gs_user number(5) not null
);
create index gs_acceso1 on gs_acceso (cdi);
create index gs_acceso2 on gs_acceso (cd_gs_toperacion);
create index gs_acceso3 on gs_acceso (parametro);
create index gs_acceso4 on gs_acceso (cd_gs_user,cdi);

CREATE TABLE gs_toperacion (
	cd_gs_toperacion char(3) not null serial,
	nm_gs_toperacion varchar2(40) not null,
	orden number(3) not null,
	grupo varchar2(10),
	activa char(1) not null
);

CREATE TABLE gs_context (
  cd_gs_conexion integer unsigned NOT NULL,
  context integer unsigned NOT NULL,
  script varchar(160) NOT NULL,
  md5_fields varchar(45) NOT NULL,
  fields_readonly varchar(255) DEFAULT NULL,
  fields_checked varchar(255) DEFAULT NULL,
  pk_seek varchar(255) DEFAULT NULL,
  field_get varchar(45) DEFAULT NULL,
  debug_md5 varchar(255) DEFAULT NULL
);
create unique index gs_context_2 on gs_context (cd_gs_conexion,context,script);

# ------------------------

CREATE TABLE gs_error (
	codigo number(5) not null serial,
	cdi timestamp,
	cd_gs_user number(5) not null,
	tipo char(1) not null,
	desde varchar2(60) not null,
	fichero varchar2(80),
	linea number(5),
	img char(1),
	pendiente char(1) null,
	texto varchar2(80) not null,
	trace varchar2(2000) not null
);
create index gs_error on gs_error (cdi);

CREATE TABLE gs_log (
	cdi timestamp not null serial,
	operacion char(1) not null,
	cd_gs_user number(4) not null,
	tabla varchar2(15) not null,
	clave varchar2(20) not null,
	sqlexe varchar2(2000) not null
);
create index gs_log1 on gs_log (clave);
create index gs_log2 on gs_log (cdi,tabla);

CREATE TABLE gs_log_tmp (
	pk_user number(5) not null,
	cdi varchar2(19) NOT NULL,
	operacion varchar2(1) NOT NULL,
	cd_gs_user number(5) not null,
	tabla varchar2(15) NOT NULL,
	campo varchar2(30) NOT NULL,
	valor varchar2(1024) NOT NULL,
	borrar varchar2(1)
);
create index gs_log_tmp on gs_log_tmp (pk_user);


create table gs_log_doc (
	cd_gs_log_doc integer unsigned NOT NULL auto_increment,
	dbtable varchar2(30) NOT NULL,
	nm_field varchar2(30) NOT NULL,
	pk integer unsigned NOT NULL,
	nm_file varchar2(120) NOT NULL,
	type_doc varchar2(4) NOT NULL,
	doc_size integer unsigned NOT NULL,
	cdi_insert datetime year to second NOT NULL,
	cd_gs_user integer unsigned NOT NULL,
	cdi_log datetime year to second NOT NULL,
	user_log integer unsigned NOT NULL
);
create index gs_log_doc1 on gs_log_doc (cd_gs_log_doc);
create index gs_log_doc2 on gs_log_doc (pk, cdi_insert);

# -------------
# EXTRACCIONES
# -------------

CREATE TABLE gs_entidad (
	cd_gs_entidad number(3) not null serial,
	nm_gs_entidad char(30) not null,
	tabla varchar2(20) not null
);

CREATE TABLE gs_grupo (
	cd_gs_entidad number(3) not null,
	cd_gs_grupo int not null serial,
	nm_gs_grupo varchar2(30),
	nota varchar2(45),
	orden number(3)
);
create unique index gs_grupo on gs_grupo (cd_gs_entidad,nm_gs_grupo);

CREATE TABLE gs_campo (
	cd_gs_campo int not null serial,
	tabla varchar2(20) not null,
	campo varchar2(80) not null,
	tipo varchar2(255),
	tipo_log varchar(60),
	ancho number(3) not null,
	decimales number(3),
	unescape char(1),
	cd_gs_entidad number(3) not null,
	cd_gs_grupo number(3) not null,
	orden number(3),
	etiqueta varchar2(30) not null,
	label_tab varchar(30),
	nivel number(3),
	virtual_field char(1),
	add_campos varchar2(30),
	log_history char(1),
	log_no_system char(1),
	log_only char(1),
	alineacion char(1) not null,
	relacion varchar2(255),
	descripcion varchar2(255),
	informe char(1),
	extraccion char(1),
	tipo_dato char(1),
	campo_ref varchar(20),
	label_inf varchar(30)
);
create index gs_campo on gs_campo (cd_gs_entidad,cd_gs_grupo,orden,etiqueta);

CREATE TABLE gs_formato (
	cd_gs_formato number(5) not null serial,
	cd_gs_user number(4) not null,
	cd_gs_entidad number(3) not null,
	grupo varchar2(20) not null,
	nm_gs_formato varchar2(60) not null,
	orientacion char(1),
	tipo_letra varchar2(50),
	ancho_letra number(3) not null,
	titulo_list varchar2(255) not null,
	descripcion varchar2(255) not null,
	formato varchar2(500) not null,
	cabecera varchar2(255) null,
	operacion varchar2(255) null,
	ordenacion varchar2(36) not null,
	destino char(1),
	cd_gs_share number(1) null,
	cd_gs_user2 number(4) null,
	cd_gs_node number(3) null,
	cd_gs_position number(3) null,
	cd_gs_tree number(2) null,
	cd_scope number(1) null,
	informe char(1)
);
create index gs_formato on gs_formato (cd_gs_user,cd_gs_entidad,grupo,nm_gs_formato);

CREATE TABLE gs_exp_file (
	cd_gs_exp_file number(5) not null serial,
	cd_gs_user number(4) not null,
	estado char(1) not null,
	tipo char(1) not null,
	formato number(3) not null,
	cd_gs_formato number(4),
	comprimido number(3) not null,
	cdi timestamp,
	download timestamp,
	fichero varchar2(20) not null,
	descargado number(3) not null,
	t_reg number(10) not null,
	sg number(11) not null,
	descripcion varchar2(60) not null,
	sql_1 varchar2(255) not null,
	sql_2 varchar2(255) not null,
	sql_3 varchar2(255) not null
);
create unique index gs_exp_file1 on gs_exp_file (cd_gs_exp_file);
create index gs_exp_file2 on gs_exp_file (cd_gs_user,cdi,descargado);
create index gs_exp_file3 on gs_exp_file (cdi);

CREATE TABLE gs_dct (
	dct_serial int NOT NULL,
	dct_field varchar2(15) NOT NULL,
	dct_work varchar2(30) NOT NULL
);
create index gs_dct on gs_dct (dct_field, dct_work);

# --------------
# MANTENIMIENTO
# --------------

CREATE TABLE gs_activity (
	cd_gs_user integer,
	cdi datetime,
	script varchar(100),
	cdi_ftp datetime,
	edes char(1),
	byts integer,
	email varchar(65)
);
create index gs_activity_1 on gs_activity (cd_gs_user, cdi);
create index gs_activity_2 on gs_activity (cd_gs_user, cdi_ftp);
create index gs_activity_3 on gs_activity (cdi);
create index gs_activity_4 on gs_activity (cdi_ftp);

CREATE TABLE gs_pack (
  cd_gs_pack not null,
  cdi datetime NOT NULL,
  cd_gs_activity integer DEFAULT NULL,
  cd_type char(1) NOT NULL,
  options varchar2(60) DEFAULT '0',
  description text NOT NULL,
  cd_gs_user integer unsigned DEFAULT NULL
);
create index gs_pack_1 on gs_activity (cd_gs_pack);
create index gs_pack_2 on gs_activity (cdi);
create index gs_pack_3 on gs_activity (options,cdi);

CREATE TABLE gs_desarrollo (
	codigo int not null serial,
	cd_tipo char(1) not null,
	cd_prioridad number(5) not null,
	dt_tope date not null,
	resumen varchar2(50) not null,
	descripcion varchar2(255) not null,
	respuesta varchar2(255) not null,
	cdi_solicitud timestamp not null,
	cdi_terminado timestamp,
	usu_solicitud number(4) not null,
	usu_terminado number(4) not null,
	cd_estado char(1) not null
	fichero varchar(65),
	menu1 int,
	menu2 int,
	menu3 int,
	menu4 int,
	menu5 int
);
create index gs_desarrollo on gs_desarrollo (codigo, cd_prioridad, cdi_solicitud);

CREATE TABLE gs_novedad (
	codigo number(5) not null serial,
	cd_tnovedades number(2),
	titulo varchar2(90),
	dt_alta date,
	cd_gs_user number(4) not null,
	resumen clob,
	options varchar2(60),
	cdi timestamp,
);
create index gs_novedad on gs_novedad (cdi);

# -----------------
# LUGAR Y USUARIOS
# -----------------

CREATE TABLE gs_pc (
	cd_gs_pc number(4) not null serial,
	nm_gs_pc char(36),
	cd_gs_node number(3) not null,
	cd_gs_user number(4) not null,
	permission char(1),
	dt_alta date not null,
	dt_del date,
	alta_usu number(2) not null,
	nota char(20),
	activar_web char(1),
	num_serie char(16)
);
create index gs_pc  on gs_pc (nm_gs_pc);
create index gs_pc2 on gs_pc (cd_gs_user);
create index gs_pc3 on gs_pc (dt_alta);

create table gs_pc_inventory(
	cd_gs_user integer,
	cd_gs_node integer,
	location varchar2(68),
	maintenance char(1),
	mac_address varchar2(12),
	machine_name varchar2(50),
	os_version varchar2(80),
	os varchar2(30),
	tick_count longinteger,
	user_domain_name varchar2(50),
	version_min_max varchar2(20),
	ram longinteger,
	processor_identifier varchar2(80),
	processor_architew6432 varchar2(20),
	processor_architecture varchar2(10),
	pcbrand varchar2(30),
	ip varchar2(15),
	ie_version varchar2(18),
	ie_version_edes varchar2(18),

	u1_unidad char(1),
	u1_byts_capacidad longinteger,
	u1_byts_libres longinteger,
	u1_sistema varchar2(20),
	u1_num_serie longinteger,

	u2_unidad char(1),
	u2_byts_capacidad longinteger,
	u2_byts_libres longinteger,
	u2_sistema varchar2(20),
	u2_num_serie longinteger,

	cdrom char(1),
	impresoras text,
	cdi_insert date,
	cdi_update date
);
create unique index gs_pc_inventory  on gs_pc_inventory (mac_address);
create        index gs_pc_inventory2 on gs_pc_inventory (cd_gs_user);
create        index gs_pc_inventory3 on gs_pc_inventory (cd_gs_node);

CREATE TABLE gs_node (
	cd_gs_node number(4) not null serial,
	nm_gs_node varchar2(60) not null,
	permission char(1),
	address varchar2(36),
	zip varchar2(5),
	nm_loca varchar2(30),
	phone varchar2(9),
	phone2 varchar2(9),
	fax varchar2(9),
	dt_add date not null,
	dt_del date,
	email varchar2(65),
	ip varchar2(15),
	ip2 varchar2(15),
	ip_from varchar2(15),
	ip_to varchar2(15),
	notes varchar2(255)
);
create index gs_node on gs_node (nm_gs_node);

CREATE TABLE gs_user (
	cd_gs_user number(4) not null serial,
	login varchar2(65) not null,
	pass varchar2(32) not null,
	cd_gs_tree number(3) not null,
	cd_gs_node number(4) not null,
	new_pass number(2),
	dt_pass date NULL,
	trigger_chr char(1),
	pc_with_id char(1),
	pc_total number(1),
	user_name varchar2(20) not null,
	user_surname varchar2(30),
	dni varchar2(8) not null,
	phone varchar2(9),
	phone2 varchar2(9),
	cd_gs_position number(3) DEFAULT '0' NULL,
	cd_gs_office number(3) DEFAULT '0' NULL,
	dt_add date,
	dt_del date null,
	email varchar2(65),
	permission char(1),
	webmaster char(1) NULL,
	log_user char(1) NULL,
	log_history char(1) NULL,
	system_user char(1) NULL,
	cd_type_tree char(1),
	cd_gs_rol integer,
	like_user integer,
	print char(1),
	excel char(1),
	xml char(1),
	txt char(1),
	pdf char(1),
	mdb char(1),
	notes varchar2(255),
	ip varchar2(15),
	ip2 varchar2(15),
	ip_from varchar2(15),
	ip_to varchar2(15),
	export_level char(1),
	ys_news timestamp,
	desktop_type number(2),
	cd_gs_theme number(2),
	confidential char(1),
	dt_confidential date NULL,
	tf_confidential char(1),
	dt_access_last date,
	view_desktop char(1),
	cd_gs_language char(2),
	host varchar(60),
	zoom_tab number(4),
	zoom_list number(4),
	task_status number(4),
	pass_doc varchar(65) NULL,
	pass_tmp varchar(32) NULL,
	pass_tmp_cdi timestamp WITH TIME ZONE NULL,
	clipping varchar(60)
);
create unique index gs_user1 on gs_user (login,pass);
create        index gs_user2 on gs_user (user_surname,user_name);
create        index gs_user3 on gs_user (task_status);

CREATE TABLE gs_position (
	cd_gs_position number(4) not null serial,
	nm_gs_position varchar2(30) NOT NULL
);
create unique index cd_gs_position on gs_position (cd_gs_position);

CREATE TABLE gs_office (
	cd_gs_office number(4) not null serial,
	nm_gs_office varchar2(40) NOT NULL
);
create unique index cd_gs_office on gs_office (cd_gs_office);

create table gs_language (
	cd_gs_language char(2) NOT NULL,
	nm_gs_language varchar2(40) NOT NULL,
	tf_translation char(1),
	img_sel varchar2(40)
);
create unique index cd_gs_language on gs_language (cd_gs_language);

create table gs_mailfrom (
	cd_mailfrom number(4) NOT NULL serial,
	cd_gs_user number(4) NOT NULL,
	mailfrom varchar2(80) NOT NULL
);
create unique index gs_mailfrom on gs_mailfrom (cd_gs_user, mailfrom);

CREATE TABLE gs_backup (
	cdi timestamp WITH TIME ZONE,
	nm_file varchar(35) NOT NULL,
	bytes_size number(11) NOT NULL,
	target varchar(50) NOT NULL,
	type varchar(100) NOT NULL,
	info varchar(255) NOT NULL
);
create index gs_backup on gs_backup (cdi);

create table gs_color (
	orden integer,
	cd_gs_color char(7),
	nm_gs_color varchar(25),
	luminosidad decimal(7,3),
	luma decimal(7,3)
);
create unique index gs_color1 on gs_color ( cd_gs_color );

create table gs_last (
	cd_gs_user integer unsigned NOT NULL,
	cdi datetime NOT NULL,
	action varchar(1) NOT NULL,
	ac_return varchar(3) NOT NULL,
	script varchar(60) NOT NULL,
	db_field varchar(20) NOT NULL,
	db_value varchar(15) NOT NULL
);
create unique index gs_last_1 on gs_last (cd_gs_user, cdi);
create unique index gs_last_2 on gs_last (cd_gs_user, script, db_value);

#------
# TAPI
#------
CREATE TABLE gs_logtapi (
	cd_gs_logtapi number(7) not null serial,
	ds_log timestamp not null,
	cd_gs_user smallint not null,
	userext number(4) not null,
	event char(1) not null,
	remoteext number(9),
	line char(1)
);
create index gs_logtapi  on gs_logtapi (ds_log);
create index gs_logtapi2 on gs_logtapi (cd_gs_user);

#----------
# Progress
#----------
create table gs_progress(
	script varchar2(30) not null,
	md5 varchar2(32),
	seconds number(4) not null
);
create index gs_progress2 on gs_progress (script,md5);

#---------
# ALERTAS
#---------

create table gs_event (
	cd_gs_event number(4) not null serial,
	nm_gs_event varchar(60) NOT NULL,
	dt_date_ev date,
	hour_ev varchar(5) NOT NULL,
	dt_alert_date_ev date,
	alert_hour_ev varchar(5),
	dt_new_date_ev date,
	new_hour_ev varchar(5),
	status_ev char(1) NOT NULL,
	frequency_ev char(1) NOT NULL,
	dt_start_ev date,
	dt_end_ev date,
	cd_gs_event_type smallint,
	cd_gs_user int DEFAULT '0' NOT NULL,
	nt_note varchar2(4000),
	old_delete_ev char(1) NOT NULL
);
create index gs_event  on gs_event (cd_gs_user, dt_date_ev, hour_ev);
create index gs_event2 on gs_event (status_ev, cd_gs_user, dt_date_ev, hour_ev);
create index gs_event3 on gs_event (cd_gs_user, nm_gs_event);

create table gs_event_user (
	cd_gs_event_user number(4) not null serial,
	cd_gs_event int DEFAULT '0' NOT NULL,
	cd_gs_user int DEFAULT '0' NOT NULL,
	dt_new_date_ev date NOT NULL,
	new_hour_ev varchar2(5),
	status_ev char(1) NOT NULL
);
create index gs_event_user on gs_event_user (cd_gs_user, dt_new_date_ev, new_hour_ev);

create table gs_event_type (
	cd_gs_event_type smallint not null serial,
	nm_gs_event_type varchar(15) NOT NULL
);
create unique index gs_event_type  on gs_event_type (cd_gs_event_type);
create unique index gs_event_type2 on gs_event_type (nm_gs_event_type);

#--------
# VARIOS
#--------

create table gs_help_file (
	cd_gs_help_file serial not null,
	nm_gs_help_file varchar(80) NOT NULL,
	nm_file varchar(80) NOT NULL,
	options varchar(100) NULL
);
create unique index gs_help_file  on gs_help_file (cd_gs_help_file);
create unique index gs_help_file2 on gs_help_file (nm_gs_help_file);

create table gs_theme (
	cd_gs_theme serial not null,
	path_css varchar(15),
	path_img varchar(15),
	nm_gs_theme varchar(45),
	tf_active char(1)
);
create unique index gs_theme  on cd_gs_theme (cd_gs_theme);
create unique index gs_theme2 on cd_gs_theme (nm_gs_theme);

#------
# CHAT
#------

CREATE TABLE gs_chat (
	cd_gs_chat int not null serial,
	action varchar(1) NOT NULL,
	user_from number(5) NOT NULL,
	user_to number(5),
	message varchar(80),
	room varchar(30),
	y2s timestamp not null
);
create index gs_chat1  on gs_chat (user_to,y2s);
create index gs_chat2  on gs_chat (room,y2s);

CREATE TABLE gs_chat_log (
	cd_gs_chat number(5) NOT NULL,
	user_owner number(5) NOT NULL,
	action varchar(1) NOT NULL,
	user_from integer NOT NULL,
	user_to number(5),
	message varchar(80),
	room varchar(30),
	y2s timestamp not null
);
create index gs_chat_log on gs_chat_log (user_owner,y2s);

CREATE TABLE gs_chat_lost (
	cd_gs_chat number(5) NOT NULL,
	action varchar(1) NOT NULL,
	user_from integer NOT NULL,
	user_to number(5),
	message varchar(80),
	room varchar(30),
	y2s timestamp not null
);
create index gs_chat_lost on gs_chat_lost (user_to,y2s);


create table gs_storage(
	type_storage char(1),
	key_storage varchar(30),
	cdi timestamp,
	note varchar(100),
	text_es varchar(4000),
	text_en varchar(4000),
	text_ca varchar(4000),
	text_fr varchar(4000)
);
create unique index gs_storage_1 on gs_storage (type_storage,key_storage);
create index gs_storage_2 on gs_storage (cdi);

#------------
# BACKGROUND
#------------

create table gs_bkg (
	cd_gs_bkg integer not null serial,
	cd_gs_user integer,
	bkg_status varchar(1),
	bkg_unique varchar(1),
	command varchar(40),
	parameters varchar(125),
	y2s_start timestamp,
	y2s_end timestamp,
	total_time varchar(8),
	bkg_pid integer,
	bkg_stime varchar(8),
	bkg_time varchar(8),
	y2s_note timestamp,
	note varchar(125),
	txt_error varchar(250)
);
create index gs_bkg1 on gs_bkg (command, bkg_status);
create index gs_bkg2 on gs_bkg (cd_gs_user, y2s_start);
create index gs_bkg3 on gs_bkg (bkg_pid);

#-----------
# RESERVADO
#-----------

# CREATE TABLE gs_informe ( );

CREATE TABLE gs_df (
	nombre varchar2(25) not null serial,
	codigo varchar2(4000) not null
);
create unique index gs_df on gs_df (nombre);

CREATE TABLE gs_store (
	cd_gs_store number(4) not null serial,
	nm_gs_store char(80) not null,
	fichero char(60) not null
	tamayo integer unsigned,
	extension varchar(4),
	fecha date,
	hora varchar(8),
	cdi datetime year to second,
	caption varchar(60),
	cd_gs_user integer,
);
create unique index gs_store on gs_store (nm_gs_store);

CREATE TABLE gs_ayuda (
	codigo number(5) not null serial,
	nombre varchar2(15) not null,
	sintaxis varchar2(60) not null,
	grupo char(2) not null,
	dt_creado date not null,
	dt_modificado date not null,
	resumen varchar2(60) not null,
	descripcion varchar2(4000) not null
);
create unique index gs_ayuda on gs_ayuda (nombre);

CREATE TABLE nota (
	asunto varchar2(50) not null,
	nota varchar2(4000) not null,
	origen number(5) not null,
	destino number(5) not null,
	leido char(1) not null,
	cd_nota number(5) not null,
	cdi timestamp not null
);

#------------
# TRADUCCION 
#------------

create table gs_script (
	cd_gs_script serial not null,
	cd_gs_script_parent integer unsigned NOT NULL,
	nm_gs_script varchar(100) NOT NULL,
	extension varchar(10) NOT NULL,
	filepath varchar(255) NOT NULL,
	short_desc varchar(255) NOT NULL,
	long_desc text NOT NULL,
	type varchar(1) NOT NULL
);
create unique index filepath_UNIQUE on gs_script (filepath);
create unique index by_parent on gs_script (cd_gs_script_parent, cd_gs_script);
create index nm_gs_script on gs_script (nm_gs_script);

create table gs_transchange (
	cd_gs_transchange serial not null,
	cd_gs_script integer NOT NULL,
	cd_gs_language char(2) NOT NULL,
	word_id varchar(500) NOT NULL,
	word_val varchar(3000) NOT NULL,
	word_val_md5 char(32) NOT NULL,
	cdi_add datetime NOT NULL,
	cdi_changed datetime NOT NULL,
	tf_changed varchar(1) NOT NULL,
	tf_script varchar(1) NOT NULL,
	comment varchar(3000) NOT NULL,
	type varchar(1) NOT NULL,
	word_val_old varchar(3000) NOT NULL,
	word_val_md5_old char(32) NOT NULL,
	gs_transchangecol varchar(45) NOT NULL
);
create unique index gs_transchange on gs_transchange (cd_gs_script, cd_gs_language, word_id);

create table gs_op_lng (
	cd_gs_op serial NOT NULL,
	cd_gs_language varchar(2) NOT NULL,
	caption_tip char(1) NOT NULL,
	caption varchar(255) NOT NULL,
	md5 char(32) NOT NULL,
	tf_changed varchar(1) NOT NULL
);
create index gs_op_lng on gs_op_lng (md5, caption_tip, cd_gs_language);

create table gs_chart (
  cd_gs_chart serial not null,
  cd_gs_user integer unsigned NOT NULL,
  script varchar(60) NOT NULL,
  dt_update date NOT NULL,
  total integer unsigned NOT NULL,
  definition varchar2(2500)
);
create index gs_chart on gs_chart (script,cd_gs_user);

CREATE TABLE gs_icon (
	cd_gs_icon varchar(6) NOT NULL,
	nm_gs_icon varchar(60) NOT NULL,
	description varchar(255),
	cdi datetime
);
create unique index gs_icon on gs_icon (cd_gs_icon);